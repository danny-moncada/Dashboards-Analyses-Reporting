INSERT OVERWRITE TABLE trendingwords SELECT bigrams.ngram[0] AS word1, bigrams.ngram[1] AS word2, bigrams.estfrequency AS estfreq FROM (SELECT EXPLODE(NGRAMS(SENTENCES(LOWER(tweet_text)), 2, 1000)) AS bigrams FROM tweets ) b;

CREATE TABLE movies (BUDGET INT, GENRES STRING, HOMEPAGE STRING, ID INT, KEYWORDS STRING, ORIGINAL_LANGUAGE STRING, ORIGINAL_TITLE STRING, OVERVIEW STRING, POPULARITY FLOAT, PRODUCTION_COMPANIES STRING, PRODUCTION_COUNTRIES STRING, RELEASE_DATE STRING, REVENUE INT, RUNTIME INT, SPOKEN_LANGUAGES STRING, STATUS STRING, TAGLINE STRING, TITLE STRING, VOTE_AVERAGE FLOAT, VOTE_COUNT INT) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ("separatorChar" = ",", "quoteChar" = "\"") LOCATION '/user/cloudera/tmdb_movies' TBLPROPERTIES("skip.header.line.count"="1");

SELECT title, GET_JSON_OBJECT(CONCAT('{"root":', production_companies, '}'), '$.root.name[0]') AS production_company FROM movies LIMIT 10;